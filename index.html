<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Basic Meta Tags -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🔥</text></svg>">
  
  <!-- PWA Meta Tags -->
  <meta name="theme-color" content="#bb86fc">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiw7p4ddixu5QjJ3yDAgIvAkrzFGNk2h_KOeDn9TzsljOPRHnPyRSmDZu4VoYPOwi1lr24VikemKzvNUveFGlhB8ersbf3FSCSjYZ7YxMU7d9AuEtMqbUS3exY19hcFQ0SSSJBstOIy3yGUGwKF9i51TSlu677sZuapKQhNGOkFg2J4uF8PoRuau5_YJwRx/s1080/Picsart_25-10-05_22-20-31-071.jpg">

  <!-- Core SEO Tags -->
  <title>BFF Quiz - Create Friendship Quiz & Challenge Friends</title>
  <meta name="description" content="🔥 Create and share your own friendship quiz! See how well your friends know you with 100+ fun questions. Challenge them now, check the leaderboard, and prove your friendship!">
  <meta name="keywords" content="friendship quiz, bff quiz, quiz game, challenge friends, test friendship, fun questions, social quiz, quiz maker">
  <meta name="author" content="LoopLabs">
  <meta name="robots" content="index, follow">
  <meta name="language" content="English">
  <meta name="revisit-after" content="7 days">
  
  <!-- Google Verification -->
  <meta name="google-site-verification" content="-pmnIIJRNoqHYPsVK-xIEiHRuNVIQd6HjsSIiR7pmLc" />
  
  <!-- Sitemap Reference -->
  <link rel="sitemap" type="application/xml" href="https://bffquiz-five.vercel.app/sitemap.xml" />
  
  <!-- Open Graph / Facebook / WhatsApp Meta Tags -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://bffquiz-five.vercel.app/">
  <meta property="og:title" content="Friendship Challenge! 🔥 BFF Quiz">
  <meta property="og:description" content="I made a quiz for my friends! Click to play, test our friendship, and see if you can beat the top score on the leaderboard. 🤔">
  <meta property="og:image" content="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgCoFt9k93c-M7Ie7ChvzCGRwBbYgZSDXOMQSL7a4XlX3fTU23SNVURs8Ws24bwaxdX8FggWULAjxaxPh_MkMAeJ4hIO_KY3gwHcreeD7KjNjRvOOSFRpXmOqfnQk-oqHsS1ka87LNRhbpwvUweUMtalcQ8ci9s8Xl-E3nUYqEd-jnMcQ4kVcmB-oRgAdE0/s1632/IMG_20251005_222112.jpg">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:type" content="image/jpeg">
  <meta property="og:site_name" content="BFF Quiz">
  <meta property="og:locale" content="en_US">

  <!-- Twitter Card Meta Tags -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://bffquiz-five.vercel.app/">
  <meta property="twitter:title" content="Friendship Challenge! 🔥 BFF Quiz">
  <meta property="twitter:description" content="I made a quiz for my friends! Click to play, test our friendship, and see if you can beat the top score on the leaderboard. 🤔">
  <meta property="twitter:image" content="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgCoFt9k93c-M7Ie7ChvzCGRwBbYgZSDXOMQSL7a4XlX3fTU23SNVURs8Ws24bwaxdX8FggWULAjxaxPh_MkMAeJ4hIO_KY3gwHcreeD7KjNjRvOOSFRpXmOqfnQk-oqHsS1ka87LNRhbpwvUweUMtalcQ8ci9s8Xl-E3nUYqEd-jnMcQ4kVcmB-oRgAdE0/s1632/IMG_20251005_222112.jpg">
  <meta property="twitter:creator" content="@looplabstech">
  <meta property="twitter:site" content="@looplabstech">

  <!-- Additional SEO Meta Tags -->
  <meta name="application-name" content="BFF Quiz">
  <meta name="msapplication-TileColor" content="#bb86fc">
  <link rel="canonical" href="https://bffquiz-five.vercel.app/">
  <link rel="alternate" hreflang="en" href="https://bffquiz-five.vercel.app/">
  <link rel="alternate" hreflang="x-default" href="https://bffquiz-five.vercel.app/">

  <!-- Preload Critical Resources -->
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" as="style">
  <link rel="preload" href="manifest.json" as="fetch" crossorigin>
  
  <!-- DNS Prefetch for External Resources -->
  <link rel="dns-prefetch" href="//jsonblob.com">
  <link rel="dns-prefetch" href="//www.highperformanceformat.com">
  <link rel="dns-prefetch" href="//www.googletagmanager.com">
  
  <!-- Structured Data (Schema Markup) for Rich Snippets -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "BFF Quiz",
    "url": "https://bffquiz-five.vercel.app/",
    "description": "Create and share friendship quizzes with your friends",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://bffquiz-five.vercel.app/search?q={search_term_string}",
      "query-input": "required name=search_term_string"
    },
    "publisher": {
      "@type": "Organization",
      "name": "LoopLabs",
      "url": "https://bffquiz-five.vercel.app/",
      "logo": {
        "@type": "imageObject",
        "url": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiw7p4ddixu5QjJ3yDAgIvAkrzFGNk2h_KOeDn9TzsljOPRHnPyRSmDZu4VoYPOwi1lr24VikemKzvNUveFGlhB8ersbf3FSCSjYZ7YxMU7d9AuEtMqbUS3exY19hcFQ0SSSJBstOIy3yGUGwKF9i51TSlu677sZuapKQhNGOkFg2J4uF8PoRuau5_YJwRx/s1080/Picsart_25-10-05_22-20-31-071.jpg"
      }
    }
  }
  </script>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [{
      "@type": "Question",
      "name": "How to create a friendship quiz on BFF Quiz?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Simply enter your name, select the number of questions you want, pick your favorite questions from our huge bank, customize the answers, and get a shareable link to challenge your friends!"
      }
    },{
      "@type": "Question",
      "name": "Is this friendship quiz free?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes, creating and sharing your friendship quiz is completely free. You can see your friends' scores on a live leaderboard."
      }
    },{
      "@type": "Question",
      "name": "How well do my friends know me?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Find out now! Create your personal quiz and share the link on WhatsApp or other social media to test your friends and see who knows you best."
      }
    }]
  }
  </script>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "BFF Quiz",
    "operatingSystem": "Web",
    "applicationCategory": "GameApplication",
    "aggregateRating": {
      "@type": "AggregateRating",
      "ratingValue": "4.8",
      "ratingCount": "1250"
    },
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    }
  }
  </script>
  
  <style>
    /* Critical CSS - Inlined for faster loading */
    :root {
      --primary-bg: #0f0f23;
      --secondary-bg: #1a1a3e;
      --card-bg: #252548;
      --border-color: #40407a;
      --primary-accent: #ff6bcb;
      --secondary-accent: #ff9a00;
      --tertiary-accent: #00d9ff;
      --text-color: white;
      --dark-text: #0f0f23;
      --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }
    * { box-sizing: border-box; font-family: 'Poppins', sans-serif; }
    body { 
      background: var(--primary-bg); 
      color: var(--text-color); 
      margin: 0;
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(255, 107, 203, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 80% 80%, rgba(0, 217, 255, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 40% 40%, rgba(255, 154, 0, 0.1) 0%, transparent 20%);
    }
    .container { 
      max-width: 600px; 
      margin: 20px auto; 
      padding: 20px; 
      background: var(--secondary-bg); 
      border-radius: 16px; 
      box-shadow: 0 10px 30px rgba(255, 107, 203, 0.2); 
      position: relative;
      overflow: hidden;
    }
    h1, h2, h3 { 
      text-align: center; 
      color: var(--primary-accent); 
      margin-top: 0; 
      margin-bottom: 20px;
      text-shadow: 0 0 10px rgba(255, 107, 203, 0.5);
    }
    input[type="text"], select, textarea { 
      width: 100%; 
      padding: 12px; 
      margin: 10px 0; 
      border: 1px solid var(--border-color); 
      border-radius: 8px; 
      background: var(--card-bg); 
      color: var(--text-color); 
      font-size: 1rem;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    button, .social-btn-stacked { 
      padding: 12px; 
      border: none; 
      border-radius: 8px; 
      cursor: pointer; 
      font-weight: bold; 
      font-size: 1rem; 
      transition: all 0.3s ease; 
      color: var(--text-color); 
      width: 100%; 
      margin: 0; 
      text-align: center; 
      text-decoration: none; 
      display: block;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .btn-purple { 
      background: linear-gradient(to right, var(--primary-accent), var(--secondary-accent)); 
    }
    button:hover, .social-btn-stacked:hover { 
      transform: translateY(-2px); 
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3); 
    }
    .main-actions { 
      display: grid; 
      grid-template-columns: 1fr 1fr; 
      gap: 15px; 
      margin: 25px 0; 
    }
    .main-action-btn { 
      display: flex; 
      align-items: center; 
      justify-content: flex-start; 
      gap: 12px; 
      padding: 15px; 
      text-align: left; 
      background: linear-gradient(135deg, var(--primary-accent), var(--secondary-accent)); 
      grid-column: span 1; 
    }
    .main-action-btn.full-width { grid-column: span 2; }
    .main-action-btn svg { width: 28px; height: 28px; flex-shrink: 0; }
    .main-action-btn div { display: flex; flex-direction: column; }
    .main-action-btn span { font-weight: bold; font-size: 1rem; }
    .main-action-btn small { font-size: 0.8rem; opacity: 0.8; font-weight: normal; }
    .question-block { 
      margin-bottom: 20px; 
      padding: 20px; 
      border: 1px solid var(--border-color); 
      border-radius: 12px; 
      background: var(--card-bg);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .hidden { display: none !important; }
    .question-title { font-weight: bold; margin-bottom: 15px; font-size: 1.1rem; }
    .option-item { 
      display: flex; 
      align-items: center; 
      padding: 12px; 
      background: var(--border-color); 
      border-radius: 8px; 
      margin-bottom: 10px;
      transition: all 0.2s ease;
    }
    .option-item:hover {
      background: rgba(255, 107, 203, 0.2);
    }
    .option-item input[type="radio"] { margin-right: 15px; flex-shrink: 0; }
    .option-item input[type="text"] { flex-grow: 1; margin: 0; }
    .correct-tick { color: #4caf50; font-weight: bold; margin-left: 10px; font-size: 1.2rem; }
    .ad-space { 
      height: auto; 
      min-height: 250px; 
      width: 100%; 
      max-width: 300px; 
      background: var(--card-bg); 
      margin: 20px auto; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      border-radius: 8px; 
      border: 1px solid var(--border-color);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .question-count-selector { display: flex; justify-content: space-around; gap: 10px; margin-bottom: 20px; }
    .count-btn { width: 100%; margin: 0; }
    .active-count { background: var(--primary-accent); color: var(--dark-text); box-shadow: 0 0 10px var(--primary-accent); }
    .alert-box { padding: 15px; background-color: #f44336; color: white; margin-bottom: 15px; border-radius: 8px; text-align: center; }
    #socialShareButtons { display: flex; flex-direction: column; gap: 10px; margin-top: 15px; }
    /* MODAL STYLES */
    #questionModal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; z-index: 1000; padding: 15px; }
    .modal-content { background: var(--secondary-bg); padding: 20px; border-radius: 12px; width: 100%; max-width: 550px; display: flex; flex-direction: column; max-height: 90vh; }
    .modal-body { overflow-y: auto; margin-bottom: 15px; border-top: 1px solid var(--border-color); border-bottom: 1px solid var(--border-color); padding: 10px 0; }
    .modal-question-item { display: flex; align-items: center; padding: 10px; margin: 5px 0; border-radius: 8px; cursor: pointer; }
    .modal-question-item:hover { background: var(--border-color); }
    .modal-question-item input[type="checkbox"] { margin-right: 15px; width: 20px; height: 20px; flex-shrink: 0; }
    .modal-footer { display: flex; gap: 10px; }
    /* BUTTON & LAYOUT FIXES */
    #creationControls { display: flex; gap: 15px; margin-top: 20px; }
    #creationControls button { flex: 1; margin: 0; }
    .quiz-history-item { cursor: pointer; padding:12px; margin-bottom: 10px; background: var(--card-bg); border-radius: 8px; }
    .quiz-history-item:hover { background: var(--border-color); }
    #leaderboard { margin-top: 25px; }
    .leaderboard-item { padding:12px; margin-bottom: 8px; background: var(--card-bg); border-radius: 8px; }
    /* FOOTER CREDIT STYLES */
    .footer-credit {
      text-align: center;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid var(--border-color);
      font-size: 1.1rem;
      font-weight: bold;
      color: #ccc;
    }
    .footer-links {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 15px;
      margin-bottom: 10px;
    }
    .footer-links a {
      color: var(--primary-accent);
      text-decoration: none;
      font-weight: 500;
      transition: color 0.3s ease;
    }
    .footer-links a:hover {
      color: var(--secondary-accent);
    }
    /* HEADER AD BANNER */
    .header-ad {
      width: 100%;
      height: 90px;
      background: var(--card-bg);
      border-radius: 8px;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 1px solid var(--border-color);
    }
    /* LOGO STYLES */
    .logo-container {
      text-align: center;
      margin-bottom: 20px;
    }
    .logo {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid var(--primary-accent);
      box-shadow: 0 0 15px rgba(255, 107, 203, 0.5);
    }
    /* INSTAGRAM BUTTON */
    .instagram-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: auto;
      min-width: 180px;
      height: 60px;
      background: linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%);
      border-radius: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
      z-index: 999;
      transition: all 0.3s ease;
      padding: 0 15px;
      text-decoration: none;
      color: white;
      font-weight: bold;
    }
    .instagram-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.5);
    }
    .instagram-btn-text {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }
    .instagram-btn-handle {
      font-size: 14px;
      font-weight: bold;
    }
    .instagram-btn-action {
      font-size: 12px;
      opacity: 0.9;
    }
    /* INSTALL PROMPT */
    .install-prompt {
      position: fixed;
      bottom: 20px;
      left: 20px;
      background: var(--secondary-bg);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 15px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      max-width: 300px;
      z-index: 999;
      display: none;
    }
    .install-prompt.show {
      display: block;
    }
    .install-prompt h4 {
      margin: 0 0 10px 0;
      color: var(--primary-accent);
    }
    .install-prompt p {
      margin: 0 0 15px 0;
      font-size: 0.9rem;
    }
    .install-prompt button {
      background: var(--primary-accent);
      color: var(--dark-text);
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      width: auto;
      margin-right: 10px;
    }
    .install-prompt .dismiss-btn {
      background: transparent;
      color: var(--text-color);
      border: 1px solid var(--border-color);
    }
    /* RATING STYLES */
    .rating-container {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 15px 0;
    }
    .rating-stars {
      display: flex;
      margin-right: 10px;
    }
    .rating-stars .star {
      color: #ffd700;
      font-size: 20px;
      margin-right: 2px;
    }
    .rating-text {
      font-size: 14px;
      color: #ccc;
    }
    .rating-count {
      font-size: 12px;
      color: #aaa;
      margin-left: 5px;
    }
    /* USER REVIEWS */
    .reviews-section {
      margin: 20px 0;
      padding: 15px;
      background: var(--card-bg);
      border-radius: 12px;
    }
    .reviews-title {
      text-align: center;
      margin-bottom: 15px;
      color: var(--primary-accent);
    }
    .review-item {
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px solid var(--border-color);
    }
    .review-item:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }
    .review-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 5px;
    }
    .reviewer-name {
      font-weight: bold;
      color: var(--primary-accent);
    }
    .review-date {
      font-size: 12px;
      color: #aaa;
    }
    .review-rating {
      margin-bottom: 5px;
    }
    .review-text {
      font-size: 14px;
      line-height: 1.4;
    }
    /* Loading Animation */
    .loader {
      border: 4px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      border-top: 4px solid var(--primary-accent);
      width: 20px;
      height: 20px;
      animation: spin 1s linear infinite;
      margin: 0 auto;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    /* NOTIFICATION STYLES */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--secondary-bg);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 15px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      max-width: 300px;
      z-index: 1001;
      transform: translateX(120%);
      transition: transform 0.3s ease;
    }
    .notification.show {
      transform: translateX(0);
    }
    .notification.error {
      border-color: #f44336;
    }
    .notification-title {
      font-weight: bold;
      margin-bottom: 5px;
      color: var(--primary-accent);
    }
    .notification-message {
      font-size: 14px;
    }
    /* DUMMY PAGE STYLES */
    #dummyPage {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 80vh;
      text-align: center;
    }
    #dummyPage h2 {
      margin-bottom: 20px;
      color: var(--primary-accent);
    }
    #dummyPage p {
      margin-bottom: 30px;
      max-width: 400px;
    }
    #dummyPage .btn-purple {
      max-width: 300px;
    }
    /* HIDDEN PAGE STYLES */
    #hiddenPage {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 80vh;
      text-align: center;
    }
    #hiddenPage h2 {
      margin-bottom: 20px;
      color: var(--primary-accent);
    }
    #hiddenPage p {
      margin-bottom: 30px;
      max-width: 400px;
    }
    #hiddenPage .btn-purple {
      max-width: 300px;
    }
    /* ABOUT PAGE STYLES */
    #aboutPage {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 80vh;
      text-align: center;
    }
    #aboutPage h2 {
      margin-bottom: 20px;
      color: var(--primary-accent);
    }
    #aboutPage p {
      margin-bottom: 20px;
      max-width: 500px;
      line-height: 1.6;
    }
    #aboutPage .contact-info {
      background: var(--card-bg);
      padding: 20px;
      border-radius: 12px;
      margin: 20px 0;
      width: 100%;
      max-width: 400px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    #aboutPage .contact-info h3 {
      margin-top: 0;
      color: var(--secondary-accent);
    }
    #aboutPage .contact-info p {
      margin: 10px 0;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    #aboutPage .contact-info a {
      color: var(--primary-accent);
      text-decoration: none;
      font-weight: 500;
      transition: color 0.3s ease;
    }
    #aboutPage .contact-info a:hover {
      color: var(--secondary-accent);
    }
    /* RANDOM QUIZ STYLES */
    #randomQuizPage {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 80vh;
      text-align: center;
    }
    #randomQuizPage h2 {
      margin-bottom: 20px;
      color: var(--primary-accent);
    }
    #randomQuizPage p {
      margin-bottom: 30px;
      max-width: 400px;
    }
    #randomQuizPage .btn-purple {
      max-width: 300px;
    }
    /* Responsive Design */
    @media (max-width: 768px) {
      .container {
        margin: 10px;
        padding: 15px;
      }
      .main-actions {
        grid-template-columns: 1fr;
        gap: 10px;
      }
      .main-action-btn.full-width {
        grid-column: span 1;
      }
      .modal-content {
        margin: 10px;
        max-width: calc(100% - 20px);
      }
      .instagram-btn {
        min-width: 150px;
        height: 50px;
        font-size: 0.9rem;
      }
    }
    /* Accessibility Improvements */
    button:focus, input:focus, select:focus, textarea:focus {
      outline: 2px solid var(--primary-accent);
      outline-offset: 2px;
    }
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0,0,0,0);
      white-space: nowrap;
      border: 0;
    }
    /* Smooth Scrolling */
    html {
      scroll-behavior: smooth;
    }
    /* Performance Optimizations */
    .lazy-load {
      opacity: 0;
      transition: opacity 0.3s;
    }
    .lazy-load.loaded {
      opacity: 1;
    }
  </style>
  
  <!-- Non-Critical CSS - Loaded after initial render -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" media="print" onload="this.media='all'">
</head>
<body>

<!-- Home Page (Default) -->
<div id="home" class="container">
  <!-- Logo -->
  <div class="logo-container">
    <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiw7p4ddixu5QjJ3yDAgIvAkrzFGNk2h_KOeDn9TzsljOPRHnPyRSmDZu4VoYPOwi1lr24VikemKzvNUveFGlhB8ersbf3FSCSjYZ7YxMU7d9AuEtMqbUS3exY19hcFQ0SSSJBstOIy3yGUGwKF9i51TSlu677sZuapKQhNGOkFg2J4uF8PoRuau5_YJwRx/s1080/Picsart_25-10-05_22-20-31-071.jpg" alt="BFF Quiz Logo" class="logo" loading="lazy">
  </div>
  
  <!-- Header Ad Banner -->
  <div class="header-ad">
    <script type="text/javascript">
      atOptions = {
        'key' : '21da5b00be19789653efc715dea56633',
        'format' : 'iframe',
        'height' : 90,
        'width' : 728,
        'params' : {}
      };
    </script>
    <script type="text/javascript" src="//www.highperformanceformat.com/21da5b00be19789653efc715dea56633/invoke.js"></script>
  </div>
  
  <h1>BFF Quiz</h1>
  <p style="text-align:center;">Create a friendship quiz & challenge your friends!</p>
  
  <!-- Rating Section -->
  <div class="rating-container">
    <div class="rating-stars">
      <span class="star">★</span>
      <span class="star">★</span>
      <span class="star">★</span>
      <span class="star">★</span>
      <span class="star">★</span>
    </div>
    <div class="rating-text">4.8<span class="rating-count">(1,250 reviews)</span></div>
  </div>
  
  <input type="text" id="userName" placeholder="Apna Naam Yahan Likhein" aria-label="Enter your name" />
  <div class="main-actions">
      <button class="main-action-btn" onclick="showCreate()" aria-label="Create a new quiz">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4v2z"></path></svg>
          <div><span>Create Quiz</span><small>Start a new challenge</small></div>
      </button>
      <button class="main-action-btn" onclick="showCreatorHistory()" aria-label="View created quizzes">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"></path></svg>
          <div><span>My Created</span><small>Check your quiz stats</small></div>
      </button>
      <button class="main-action-btn full-width" onclick="showPlayerHistory()" aria-label="View your scores">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-4h2v4zm4 0h-2v-7h-2v7zm4 0h-2V7h-2v7zm4 0h-2V7h-2v7z"></path></svg>
          <div><span>My Scores</span><small>Check your past results</small></div>
      </button>
  </div>
  <!-- Ad Space (Top) -->
  <div class="ad-space">
    <script type="text/javascript">
      atOptions = {
        'key' : 'c0efb17d6a9b43764d3fe4e7973a31a0',
        'format' : 'iframe',
        'height' : 250,
        'width' : 300,
        'touch-icon' : 'true',
        'params' : {}
      };
    </script>
    <script type="text/javascript" src="//www.highperformanceformat.com/c0efb17d6a9b43764d3fe4e7973a31a0/invoke.js"></script>
  </div>
  
  <!-- User Reviews Section - Moved Above Footer -->
  <div class="reviews-section">
    <h3 class="reviews-title">What Users Are Saying</h3>
    <div class="review-item">
      <div class="review-header">
        <span class="reviewer-name">Priya Sharma</span>
        <span class="review-date">2 days ago</span>
      </div>
      <div class="review-rating">
        <span class="star">★</span>
        <span class="star">★</span>
        <span class="star">★</span>
        <span class="star">★</span>
        <span class="star">★</span>
      </div>
      <div class="review-text">Amazing app! Created a quiz for my friends and we had so much fun. The questions are great and the interface is super easy to use.</div>
    </div>
    <div class="review-item">
      <div class="review-header">
        <span class="reviewer-name">Rahul Verma</span>
        <span class="review-date">1 week ago</span>
      </div>
      <div class="review-rating">
        <span class="star">★</span>
        <span class="star">★</span>
        <span class="star">★</span>
        <span class="star">★</span>
        <span class="star">☆</span>
      </div>
      <div class="review-text">Love this app! It's become our go-to activity at parties. The leaderboard feature makes it competitive and fun.</div>
    </div>
  </div>
  
  <!-- Footer -->
  <div class="footer-credit">
    <p>LoopLabs - All Rights Reserved</p>
    <div class="footer-links">
      <a href="#" onclick="showRandomQuiz(); return false;">Random Quiz</a>
      <a href="#" onclick="showAboutPage(); return false;">About</a>
    </div>
  </div>
</div>

<!-- Create Quiz Page -->
<div id="create" class="container hidden">
  <!-- Logo -->
  <div class="logo-container">
    <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiw7p4ddixu5QjJ3yDAgIvAkrzFGNk2h_KOeDn9TzsljOPRHnPyRSmDZu4VoYPOwi1lr24VikemKzvNUveFGlhB8ersbf3FSCSjYZ7YxMU7d9AuEtMqbUS3exY19hcFQ0SSSJBstOIy3yGUGwKF9i51TSlu677sZuapKQhNGOkFg2J4uF8PoRuau5_YJwRx/s1080/Picsart_25-10-05_22-20-31-071.jpg" alt="BFF Quiz Logo" class="logo" loading="lazy">
  </div>
  
  <h2>Create Your Quiz</h2>
  <div class="question-count-selector">
    <button class="count-btn btn-purple" onclick="setQuestionCount(5)" aria-label="Select 5 questions">5 Qs</button>
    <button class="count-btn btn-purple" onclick="setQuestionCount(10)" aria-label="Select 10 questions">10 Qs</button>
    <button class="count-btn btn-purple" onclick="setQuestionCount(15)" aria-label="Select 15 questions">15 Qs</button>
    <button class="count-btn btn-purple" onclick="setQuestionCount(20)" aria-label="Select 20 questions">20 Qs</button>
  </div>
  <button class="btn-purple" onclick="showQuestionModal()" style="margin-bottom:20px;" aria-label="Select questions from bank">Select Questions from Bank</button>
  <p id="questionCounter" style="text-align: center; margin-bottom: 20px;" aria-live="polite"></p>
  <div id="questionsContainer"><p style="text-align:center; opacity: 0.7;">Your selected questions will appear here for final review.</p></div>
  <div id="creationControls" class="hidden">
      <button class="btn-purple" onclick="shuffleSelectedQuestions()" aria-label="Shuffle questions">Shuffle Questions</button>
      <button class="btn-purple" onclick="finishAndShareQuiz()" aria-label="Finish and share quiz">Finish & Share Link</button>
  </div>
  <!-- Ad Space (Middle) -->
  <div class="ad-space">
    <script type="text/javascript">
      atOptions = {
        'key' : 'c0efb17d6a9b43764d3fe4e7973a31a0',
        'format' : 'iframe',
        'height' : 250,
        'width' : 300,
        'touch-icon' : 'true',
        'params' : {}
      };
    </script>
    <script type="text/javascript" src="//www.highperformanceformat.com/c0efb17d6a9b43764d3fe4e7973a31a0/invoke.js"></script>
  </div>
  <!-- Footer -->
  <div class="footer-credit">
    <p>LoopLabs - All Rights Reserved</p>
    <div class="footer-links">
      <a href="#" onclick="showRandomQuiz(); return false;">Random Quiz</a>
      <a href="#" onclick="showAboutPage(); return false;">About</a>
    </div>
  </div>
</div>

<!-- Play Quiz Page -->
<div id="play" class="container hidden">
  <!-- Logo -->
  <div class="logo-container">
    <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiw7p4ddixu5QjJ3yDAgIvAkrzFGNk2h_KOeDn9TzsljOPRHnPyRSmDZu4VoYPOwi1lr24VikemKzvNUveFGlhB8ersbf3FSCSjYZ7YxMU7d9AuEtMqbUS3exY19hcFQ0SSSJBstOIy3yGUGwKF9i51TSlu677sZuapKQhNGOkFg2J4uF8PoRuau5_YJwRx/s1080/Picsart_25-10-05_22-20-31-071.jpg" alt="BFF Quiz Logo" class="logo" loading="lazy">
  </div>
  
  <h2 id="quizTitle"></h2>
  <div id="playTakerName">
      <input type="text" id="takerName" placeholder="Apna Naam Yahan Likhein" aria-label="Enter your name" />
      <button class="btn-purple" onclick="startQuiz()" aria-label="Start quiz">Start Quiz</button>
      <!-- Ad Slot 1: Below Start Quiz Button -->
      <div id="startQuizAd" class="ad-space" style="margin-top:20px;">
        <script type="text/javascript">
          atOptions = {
            'key' : 'c0efb17d6a9b43764d3fe4e7973a31a0',
            'format' : 'iframe',
            'height' : 250,
            'width' : 300,
            'touch-icon' : 'true',
            'params' : {}
          };
        </script>
        <script type="text/javascript" src="//www.highperformanceformat.com/c0efb17d6a9b43764d3fe4e7973a31a0/invoke.js"></script>
      </div>
  </div>
  <div id="quizContentWrapper" class="hidden">
    <div id="quizContent">
      <!-- Questions will be dynamically loaded here -->
    </div>
    <!-- Ad Slot 2: Below Next Question Button -->
    <div id="inQuizAd" class="ad-space hidden" style="margin-top:0;">
      <script type="text/javascript">
        atOptions = {
          'key' : 'c0efb17d6a9b43764d3fe4e7973a31a0',
          'format' : 'iframe',
          'height' : 250,
          'width' : 300,
          'touch-icon' : 'true',
          'params' : {}
        };
      </script>
      <script type="text/javascript" src="//www.highperformanceformat.com/c0efb17d6a9b43764d3fe4e7973a31a0/invoke.js"></script>
    </div>
  </div>
</div>

<!-- Result & Share Page -->
<div id="result" class="container hidden">
  <!-- Logo -->
  <div class="logo-container">
    <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiw7p4ddixu5QjJ3yDAgIvAkrzFGNk2h_KOeDn9TzsljOPRHnPyRSmDZu4VoYPOwi1lr24VikemKzvNUveFGlhB8ersbf3FSCSjYZ7YxMU7d9AuEtMqbUS3exY19hcFQ0SSSJBstOIy3yGUGwKF9i51TSlu677sZuapKQhNGOkFg2J4uF8PoRuau5_YJwRx/s1080/Picsart_25-10-05_22-20-31-071.jpg" alt="BFF Quiz Logo" class="logo" loading="lazy">
  </div>
  
  <h2 id="resultTitle"></h2>
  <div id="scoreText"></div>
  <div id="leaderboard" class="hidden">
      <h3>🏆 Leaderboard</h3>
      <div id="leaderboardList">Loading...</div>
  </div>
  <div id="shareBox" class="hidden">
      <h3>Share this Quiz!</h3>
      <p>Challenge your friends to beat your score!</p>
      <div id="shareLink" class="hidden"></div>
      <div id="socialShareButtons">
          <!-- Buttons will be generated by JS here -->
      </div>
  </div>
   <!-- Ad Space (Bottom on Result Page / Under Leaderboard) -->
   <div class="ad-space">
    <script type="text/javascript">
      atOptions = {
        'key' : 'c0efb17d6a9b43764d3fe4e7973a31a0',
        'format' : 'iframe',
        'height' : 250,
        'width' : 300,
        'touch-icon' : 'true',
        'params' : {}
      };
    </script>
    <script type="text/javascript" src="//www.highperformanceformat.com/c0efb17d6a9b43764d3fe4e7973a31a0/invoke.js"></script>
   </div>
  <button class="btn-purple" onclick="location.href=location.pathname" style="margin-top: 20px;" aria-label="Create your own quiz">Create Your Own Quiz</button>
  <!-- Footer -->
  <div class="footer-credit">
    <p>LoopLabs - All Rights Reserved</p>
    <div class="footer-links">
      <a href="#" onclick="showRandomQuiz(); return false;">Random Quiz</a>
      <a href="#" onclick="showAboutPage(); return false;">About</a>
    </div>
  </div>
</div>

<!-- CREATOR History Page -->
<div id="creatorHistoryPage" class="container hidden">
  <!-- Logo -->
  <div class="logo-container">
    <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiw7p4ddixu5QjJ3yDAgIvAkrzFGNk2h_KOeDn9TzsljOPRHnPyRSmDZu4VoYPOwi1lr24VikemKzvNUveFGlhB8ersbf3FSCSjYZ7YxMU7d9AuEtMqbUS3exY19hcFQ0SSSJBstOIy3yGUGwKF9i51TSlu677sZuapKQhNGOkFg2J4uF8PoRuau5_YJwRx/s1080/Picsart_25-10-05_22-20-31-071.jpg" alt="BFF Quiz Logo" class="logo" loading="lazy">
  </div>
  
    <div id="creatorHistoryWrapper">
        <h2>My Created Quizzes</h2>
        <div id="creatorHistoryList"></div>
    </div>
    <div id="creatorLeaderboardView" class="hidden">
        <h3 id="creatorLeaderboardTitle"></h3>
        <p id="creatorPlayerCount" style="text-align:center; font-weight:bold;"></p>
        <div id="creatorLeaderboardList"></div>
        <button class="btn-purple" onclick="showCreatorHistoryList()" style="margin-top:20px;" aria-label="Back to quiz list">Back to Quiz List</button>
    </div>
    <!-- Ad Space (Creator History) -->
    <div class="ad-space">
      <script type="text/javascript">
        atOptions = {
          'key' : 'c0efb17d6a9b43764d3fe4e7973a31a0',
          'format' : 'iframe',
          'height' : 250,
          'width' : 300,
          'touch-icon' : 'true',
          'params' : {}
        };
      </script>
      <script type="text/javascript" src="//www.highperformanceformat.com/c0efb17d6a9b43764d3fe4e7973a31a0/invoke.js"></script>
    </div>
    <button class="btn-purple" onclick="showPage('home')" style="margin-top:20px;" aria-label="Back to home">Back to Home</button>
</div>

<!-- PLAYER History Page (My Scores) -->
<div id="playerHistoryPage" class="container hidden">
  <!-- Logo -->
  <div class="logo-container">
    <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiw7p4ddixu5QjJ3yDAgIvAkrzFGNk2h_KOeDn9TzsljOPRHnPyRSmDZu4VoYPOwi1lr24VikemKzvNUveFGlhB8ersbf3FSCSjYZ7YxMU7d9AuEtMqbUS3exY19hcFQ0SSSJBstOIy3yGUGwKF9i51TSlu677sZuapKQhNGOkFg2J4uF8PoRuau5_YJwRx/s1080/Picsart_25-10-05_22-20-31-071.jpg" alt="BFF Quiz Logo" class="logo" loading="lazy">
  </div>
  
  <h2>My Score History</h2>
  <div id="playerHistoryList"></div>
  <!-- Ad Space (Player History) -->
  <div class="ad-space">
    <script type="text/javascript">
      atOptions = {
        'key' : 'c0efb17d6a9b43764d3fe4e7973a31a0',
        'format' : 'iframe',
        'height' : 250,
        'width' : 300,
        'touch-icon' : 'true',
        'app-id" : 'true',
        'params' : {}
      };
    </script>
    <script type="text/javascript" src="//www.highperformanceformat.com/c0efb17d6a9b43764d3fe4e7973a31a0/invoke.js"></script>
  </div>
  <button class="btn-purple" onclick="showPage('home')" style="margin-top:20px;" aria-label="Back to home">Back to Home</button>
</div>

<!-- Random Quiz Page -->
<div id="randomQuizPage" class="container hidden">
  <!-- Logo -->
  <div class="logo-container">
    <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiw7p4ddixu5QjJ3yDAgIvAkrzFGNk2h_KOeDn9TzsljOPRHnPyRSmDZu4VoYPOwi1lr24VikemKzvNUveFGlhB8ersbf3FSCSjYZ7YxMU7d9AuEtMqbUS3exY19hcFQ0SSSJBstOIy3yGUGwKF9i51TSlu677sZuapKQhNGOkFg2J4uF8PoRuau5_YJwRx/s1080/Picsart_25-10-05_22-20-31-071.jpg" alt="BFF Quiz Logo" class="logo" loading="lazy">
  </div>
  
  <h1>Random Quiz</h1>
  <p style="text-align:center;">Try our randomly generated friendship quiz!</p>
  
  <div id="randomQuiz">
    <div class="question-block">
      <h3 id="randomQuestionText">Loading question...</h3>
      <div id="randomOptions"></div>
    </div>
    
    <button class="btn-purple" onclick="submitRandomQuiz()">Submit Answer</button>
    <button class="btn-purple" onclick="generateNewRandomQuestion()">New Question</button>
    <button class="btn-purple" onclick="showPage('home')">Back to Home</button>
  </div>
  
  <div id="randomResult" class="hidden">
    <h2>Your Answer</h2>
    <p id="randomAnswerText" style="text-align:center; font-size: 1.2rem;"></p>
    <p id="randomExplanation" style="text-align:center; margin: 20px 0;"></p>
    <button class="btn-purple" onclick="generateNewRandomQuestion()">Try Another Question</button>
    <button class="btn-purple" onclick="showPage('home')">Back to Home</button>
  </div>
  
  <!-- Footer -->
  <div class="footer-credit">
    <p>LoopLabs - All Rights Reserved</p>
    <div class="footer-links">
      <a href="#" onclick="showPage('home'); return false;">Home</a>
      <a href="#" onclick="showAboutPage(); return false;">About</a>
    </div>
  </div>
</div>

<!-- About Page -->
<div id="aboutPage" class="container hidden">
  <!-- Logo -->
  <div class="logo-container">
    <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiw7p4ddixu5QjJ3yDAgIvAkrzFGNk2h_KOeDn9TzsljOPRHnPyRSmDZu4VoYPOwi1lr24VikemKzvNUveFGlhB8ersbf3FSCSjYZ7YxMU7d9AuEtMqbUS3exY19hcFQ0SSSJBstOIy3yGUGwKF9i51TSlu677sZuapKQhNGOkFg2J4uF8PoRuau5_YJwRx/s1080/Picsart_25-10-05_22-20-31-071.jpg" alt="BFF Quiz Logo" class="logo" loading="lazy">
  </div>
  
  <h1>About BFF Quiz</h1>
  <p>BFF Quiz is a fun and interactive platform that allows you to create personalized friendship quizzes to test how well your friends know you. With our extensive question bank, you can create unique quizzes that reveal interesting aspects of your personality and friendships.</p>
  
  <p>Our mission is to strengthen friendships through fun and engaging challenges. Whether you're at a party, hanging out with friends, or just want to have some fun online, BFF Quiz is the perfect way to connect and create memorable moments.</p>
  
  <div class="contact-info">
    <h3>Contact Us</h3>
    <p>
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="2" y="4" width="20" height="16" rx="2"></rect>
        <path d="m22 7-10 5L2 7"></path>
      </svg>
      <a href="mailto:contact@looplabs.tech">contact@looplabs.tech</a>
    </p>
    <p>
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect width="20" height="20" x="2" y="2" rx="5" ry="5"></rect>
        <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
        <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
      </svg>
      <a href="https://www.instagram.com/looplabstech" target="_blank">@looplabstech</a>
    </p>
    <p>
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 19.91 1"></path>
      </svg>
      <a href="https://github.com/looplabstech" target="_blank">github.com/looplabstech</a>
    </p>
  </div>
  
  <button class="btn-purple" onclick="showPage('home')">Back to Home</button>
  
  <!-- Footer -->
  <div class="footer-credit">
    <p>LoopLabs - All Rights Reserved</p>
    <div class="footer-links">
      <a href="#" onclick="showRandomQuiz(); return false;">Random Quiz</a>
      <a href="#" onclick="showPage('home'); return false;">Home</a>
    </div>
  </div>
</div>

<!-- Dummy Page (Hidden) -->
<div id="dummyPage" class="container hidden">
  <div id="dummyPageContent">
    <h2>This is a Hidden Page</h2>
    <p>This page is not accessible from the main navigation. It's only accessible through direct links and is included in the sitemap for SEO purposes.</p>
    <button class="btn-purple" onclick="showPage('home')" aria-label="Go to home page">Go to Home Page</button>
  </div>
</div>

<!-- Hidden Page (SEO Only) -->
<div id="hiddenPage" class="container hidden">
  <div id="hiddenPageContent">
    <h2>BFF Quiz - SEO Page</h2>
    <p>This is a hidden page designed specifically for SEO purposes. It helps improve the website's visibility on search engines and ensures better indexing.</p>
    <p>BFF Quiz is a fun and interactive way to test your friendship bonds. Create custom quizzes with our extensive question bank and challenge your friends to see who knows you best!</p>
    <p>Features include:</p>
    <ul style="text-align: left; max-width: 400px;">
      <li>100+ pre-written questions</li>
      <li>Customizable quiz options</li>
      <li>Real-time leaderboards</li>
      <li>Social sharing capabilities</li>
      <li>Mobile-friendly design</li>
    </ul>
    <button class="btn-purple" onclick="showPage('home')" aria-label="Go to home page">Go to Home Page</button>
  </div>
</div>

<!-- SEO Page (Hidden from users, visible to search engines) -->
<div id="seoPage" class="container hidden" style="display:none !important; visibility:hidden; position:absolute; left:-9999px; top:-9999px;">
  <div id="seoPageContent">
    <h1>BFF Quiz - The Ultimate Friendship Challenge</h1>
    <p>Discover the most engaging way to test your friendships with BFF Quiz! Our innovative platform allows you to create personalized quizzes with over 100 carefully crafted questions that will reveal how well your friends truly know you.</p>
    
    <h2>Why Choose BFF Quiz?</h2>
    <ul>
      <li>Create custom quizzes in minutes with our intuitive interface</li>
      <li>Choose from our extensive question bank covering various aspects of friendship</li>
      <li>Share quizzes instantly on WhatsApp, Instagram, and other social platforms</li>
      <li>Track scores with real-time leaderboards</li>
      <li>Enjoy a mobile-optimized experience that works seamlessly on all devices</li>
    </ul>
    
    <h2>How It Works</h2>
    <ol>
      <li>Enter your name to get started</li>
      <li>Select the number of questions for your quiz (5, 10, 15, or 20)</li>
      <li>Pick your favorite questions from our comprehensive bank</li>
      <li>Customize answers to make the quiz truly personal</li>
      <li>Share the generated link with your friends</li>
      <li>Watch as they take the quiz and see who knows you best!</li>
    </ol>
    
    <h2>Perfect for Every Occasion</h2>
    <p>BFF Quiz is ideal for:</p>
    <ul>
      <li>Birthday parties and gatherings</li>
      <li>Sleepovers and get-togethers</li>
      <li>Virtual hangouts with friends</li>
      <li>Icebreakers at events</li>
      <li>Just having fun with your closest friends</li>
    </ul>
    
    <h2>Join Thousands of Happy Users</h2>
    <p>With over 1,250 five-star reviews, BFF Quiz has become the go-to app for friendship challenges. Join the community today and discover what makes your friendships special!</p>
    
    <p>Download BFF Quiz now and start creating memorable moments with your friends!</p>
  </div>
</div>

<!-- Question Selection Modal -->
<div id="questionModal" class="container hidden">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Select Your Questions</h3>
      <input type="text" id="questionSearch" onkeyup="renderModalList()" placeholder="Search for questions..." aria-label="Search questions">
      <p id="modalCounter" style="text-align:center; margin: 5px 0;" aria-live="polite"></p>
    </div>
    <div class="modal-body" id="questionList"></div>
    <div class="modal-footer">
      <button class="btn-purple" style="flex:2" onclick="addSelectedQuestions()" aria-label="Add selected questions">Add Selected Questions</button>
      <button class="btn-purple" style="flex:1" onclick="closeQuestionModal()" aria-label="Cancel selection">Cancel</button>
    </div>
  </div>
</div>

<!-- Instagram Follow Button (Text Only) -->
<a href="https://www.instagram.com/looplabstech?igsh=MW11cDRoMnhmdDBqaw==" target="_blank" class="instagram-btn" aria-label="Follow us on Instagram">
  <div class="instagram-btn-text">
    <div class="instagram-btn-handle">@looplabstech</div>
    <div class="instagram-btn-action">Click to Follow</div>
  </div>
</a>

<!-- Install Prompt -->
<div id="installPrompt" class="install-prompt">
  <h4>Install BFF Quiz</h4>
  <p>Install our app for a better experience!</p>
  <button id="installBtn" aria-label="Install app">Install</button>
  <button id="dismissBtn" class="dismiss-btn" aria-label="Dismiss prompt">Not now</button>
</div>

<!-- Notification Container -->
<div id="notification" class="notification" role="alert" aria-live="polite">
  <div class="navigation-notification">
    <div class="notification-title"></div>
    <div class="notification-message"></div>
  </div>
</div>

<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1NQGWBSRLQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-1NQGWBSRLQ');
</script>

<!-- Service Worker Registration -->
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/sw.js')
      .then(function(registration) {
        console.log('ServiceWorker registration successful with scope: ', registration.scope);
      })
      .catch(function(err) {
        console.log('ServiceWorker registration failed: ', err);
      });
  });
}
</script>

<script>
// --- MASSIVE QUESTION BANK (100 Questions) ---
const allQuestions = [
    // Favorites
    { q: "What's my favorite food?", o: ["Pizza", "Biryani", "Pasta", "Burger"], a: "Biryani" },
    { q: "What's my favorite movie genre?", o: ["Action", "Comedy", "Sci-Fi", "Horror"], a: "Sci-Fi" },
    { q: "What is my favorite color?", o: ["Black", "Blue", "Red", "Green"], a: "Black" },
    { q: "What is my favorite season?", o: ["Winter", "Summer", "Monsoon", "Spring"], a: "Winter" },
    { q: "My favorite type of music?", o: ["Bollywood", "Hip-Hop", "Rock", "Pop"], a: "Bollywood" },
    { q: "My favorite animal?", o: ["Dog", "Cat", "Wolf", "Lion"], a: "Dog" },
    { q: "My favorite festival?", o: ["Diwali", "Holi", "Christmas", "Eid"], a: "Diwali" },
    { q: "My favorite superhero?", o: ["Iron Man", "Batman", "Spider-Man", "Superman"], a: "Iron Man" },
    { q: "My favorite ice cream flavor?", o: ["Chocolate", "Vanilla", "Butterscotch", "Strawberry"], a: "Chocolate" },
    { q: "My favorite Indian street food?", o: ["Pani Puri", "Samosa", "Vada Pav", "Chole Bhature"], a: "Pani Puri" },
    { q: "My favorite beverage?", o: ["Tea", "Coffee", "Juice", "Cold Drink"], a: "Coffee" },
    { q: "My favorite sport to watch?", o: ["Cricket", "Football", "Kabaddi", "Tennis"], a: "Cricket" },
    { q: "My favorite book genre?", o: ["Fantasy", "Mystery", "Biography", "Self-help"], a: "Fantasy" },
    { q: "My favorite dessert?", o: ["Gulab Jamun", "Cake", "Ice Cream", "Jalebi"], a: "Gulab Jamun" },
    { q: "My favorite social media app?", o: ["Instagram", "Twitter", "YouTube", "Snapchat"], a: "Instagram" },
    { q: "Which phone brand do I like most?", o: ["Apple", "Samsung", "OnePlus", "Google Pixel"], a: "OnePlus" },
    { q: "My favorite type of vacation?", o: ["Mountains", "Beaches", "City Tour", "Adventure Trip"], a: "Mountains" },
    { q: "My favorite subject in school was?", o: ["Math", "Science", "History", "Computers"], a: "Computers" },
    { q: "My favorite car brand?", o: ["BMW", "Mercedes", "Audi", "Tata"], a: "BMW" },
    { q: "My favorite fast food chain?", o: ["McDonald's", "KFC", "Domino's", "Subway"], a: "Domino's" },
    // Habits & Lifestyle
    { q: "Am I a morning person or a night owl?", o: ["Morning Person", "Night Owl", "Both", "Neither"], a: "Night Owl" },
    { q: "How do I prefer to travel?", o: ["Car", "Train", "Flight", "Bike"], a: "Bike" },
    { q: "What's my go-to outfit?", o: ["Jeans & T-shirt", "Formal Wear", "Kurta", "Tracksuit"], a: "Jeans & T-shirt" },
    { q: "How many languages can I speak?", o: ["One", "Two", "Three", "More than three"], a: "Two" },
    { q: "Do I prefer Android or iOS?", o: ["Android", "iOS", "Doesn't matter", "Hate both"], a: "Android" },
    { q: "My zodiac sign is?", o: ["Aries", "Leo", "Scorpio", "Capricorn"], a: "Scorpio" },
    { q: "Do I wear glasses?", o: ["Yes, always", "Only for reading", "No", "Contact lenses"], a: "Yes, always" },
    { q: "What is my biggest pet peeve?", o: ["Loud chewing", "Slow walkers", "People on phone", "Bad grammar"], a: "Loud chewing" },
    { q: "Am I an introvert or an extrovert?", o: ["Introvert", "Extrovert", "Ambivert", "Depends on mood"], a: "Ambivert" },
    { q: "How do I take my coffee/tea?", o: ["Black", "With milk & sugar", "Lots of sugar", "I don't drink it"], a: "With milk & sugar" },
    { q: "Am I a messy or a tidy person?", o: ["Very Tidy", "My Created", "A bit Messy", "Very Messy"], a: "A bit Messy" },
    { q: "What's my birth month?", o: ["January", "April", "August", "November"], a: "November" },
    { q: "Do I like spicy food?", o: ["Not at all", "A little bit", "Yes, quite spicy", "The spicier, the better!"], a: "The spicier, the better!" },
    { q: "How often do I exercise?", o: ["Every day", "A few times a week", "Rarely", "What's exercise?"], a: "Rarely" },
    { q: "Am I a planner or spontaneous?", o: ["I plan everything", "Mostly spontaneous", "A bit of both", "100% spontaneous"], a: "A bit of both" },
    { q: "What's one thing I can't live without?", o: ["My Phone", "Internet", "Family", "Food"], a: "My Phone" },
    { q: "What is my relationship status?", o: ["Single", "In a relationship", "It's complicated", "Ask me in person"], a: "Single" },
    { q: "Am I left-handed or right-handed?", o: ["Right-handed", "Left-handed", "Ambidextrous", "Guess!"], a: "Right-handed" },
    { q: "Do I sing in the shower?", o: ["Yes, always!", "Sometimes", "Never", "Only when no one's home"], a: "Only when no one's home" },
    { q: "What's my shoe size?", o: ["7", "8", "9", "10"], a: "9" },
    // Opinions & Preferences
    { q: "Which superpower would I choose?", o: ["Flying", "Invisibility", "Mind Reading", "Super Strength"], a: "Invisibility" },
    { q: "If I could live anywhere, where would it be?", o: ["New York", "A quiet village", "London", "Tokyo"], a: "Tokyo" },
    { q: "Movies or Web Series?", o: ["Movies", "Web Series", "Both", "Neither"], a: "Web Series" },
    { q: "What would I do with 1 crore rupees?", o: ["Travel the world", "Invest it", "Buy a house", "Start a business"], a: "Travel the world" },
    { q: "Do I believe in ghosts?", o: ["Yes, absolutely", "Maybe, not sure", "No, it's nonsense", "I want to believe"], a: "Maybe, not sure" },
    { q: "Which is better: Money or Fame?", o: ["Money", "Fame", "Both are important", "Neither is important"], a: "Money" },
    { q: "What's my dream job?", o: ["Doctor", "YouTuber", "Software Engineer", "Traveller"], a: "Traveller" },
    { q: "What's more important: looks or intelligence?", o: ["Looks", "Intelligence", "A balance of both", "Sense of humor"], a: "Sense of humor" },
    { q: "If I were an animal, I would be a:", o: ["Eagle", "Wolf", "Dolphin", "Panda"], a: "Wolf" },
    { q: "Do I prefer texting or calling?", o: ["Texting", "Calling", "Depends on person", "Video calls"], a: "Texting" },
    { q: "What's my opinion on pineapple on pizza?", o: ["Love it!", "It's a crime", "I can tolerate it", "Never tried it"], a: "It's a crime" },
    { q: "Which social cause do I care about most?", o: ["Environment", "Education", "Animal Welfare", "Poverty"], a: "Education" },
    { q: "Which character from 'Friends' am I most like?", o: ["Chandler", "Joey", "Monica", "Rachel"], a: "Chandler" },
    { q: "What's my biggest fear?", o: ["Heights", "Spiders", "Public speaking", "Failure"], a: "Failure" },
    { q: "What's a skill I want to learn?", o: ["Playing guitar", "A new language", "Coding", "Cooking"], a: "Playing guitar" },
    { q: "Which Hogwarts House would I be in?", o: ["Gryffindor", "Slytherin", "Ravenclaw", "Hufflepuff"], a: "Slytherin" },
    { q: "What's my ideal first date?", o: ["Coffee shop", "Fancy dinner", "Movie night", "Adventure activity"], a: "Adventure activity" },
    { q: "Do I prefer city life or village life?", o: ["City life", "Village life", "A mix of both", "Doesn't matter"], a: "City life" },
    { q: "What's a movie that made me cry?", o: ["Titanic", "3 Idiots", "Taare Zameen Par", "I don't cry in movies"], a: "Taare Zameen Par" },
    { q: "What am I most proud of?", o: ["My career", "My friends", "My education", "My honesty"], a: "My friends" },
    // Personal & Friendship
    { q: "Where did we first meet?", o: ["School", "College", "Work", "Online"], a: "College" },
    { q: "What is my nickname?", o: ["Sonu", "Raju", "Pappu", "I don't have one"], a: "Raju" },
    { q: "What's my middle name?", o: ["Kumar", "Singh", "Don't have one", "It's a secret"], a: "Kumar" },
    { q: "What am I most likely to be arrested for?", o: ["Speeding", "Arguing with police", "Hacking", "I'm a good citizen"], a: "Arguing with police" },
    { q: "What's the one word my friends use to describe me?", o: ["Funny", "Smart", "Loyal", "Crazy", "Crazy"], a: "Funny" },
    { q: "What is my biggest insecurity?", o: ["My looks", "My career", "My future", "I'm very secure"], a: "My future" },
    { q: "If I needed help, what would I ask for?", o: ["Money", "Advice", "A ride", "Emotional support"], a: "Emotional support" },
    { q: "What's my go-to excuse for being late?", o: ["Traffic", "Woke up late", "Feeling unwell", "I'm never late"], a: "Traffic" },
    { q: "What's my most used emoji?", o: ["😂", "❤️", "👍", "🤔"], a: "😂" },
    { q: "What do I value most in a friendship?", o: ["Honesty", "Loyalty", "Fun", "Support"], a: "Loyalty" },
    { q: "What's a secret I've never told anyone?", o: ["My first crush", "An embarrassing moment", "A hidden talent", "Nice try!"], a: "Nice try!" },
    { q: "What gift would I love the most?", o: ["Gadget", "A surprise trip", "Handmade gift", "Clothes"], a: "A surprise trip" },
    { q: "How many siblings do I have?", o: ["None (only child)", "One", "Two", "More than two"], a: "One" },
    { q: "What was the color of my school uniform?", o: ["Blue and White", "Brown and Cream", "Grey and White", "All White"], a: "Blue and White" },
    { q: "Which celebrity do I have a crush on?", o: ["Alia Bhatt", "Deepika Padukone", "Kiara Advani", "Disha Patani"], a: "Kiara Advani" },
    { q: "What's my dream bike/car?", o: ["Royal Enfield", "Harley-Davidson", "Lamborghini", "Thar"], a: "Thar" },
    { q: "Am I a dog person or a cat person?", o: ["Dog Person", "Cat Person", "Both", "Neither"], a: "Dog Person" },
    { q: "What's my biggest turn-off?", o: ["Arrogance", "Bad hygiene", "Lying", "Lack of ambition"], a: "Arrogance" },
    { q: "Which game am I best at?", o: ["BGMI/PUBG", "Chess", "Ludo", "Call of Duty"], a: "BGMI/PUBG" },
    { q: "What's my mother tongue?", o: ["Hindi", "English", "Marathi", "Bengali"], a: "Hindi" },
    // Hypotheticals
    { q: "If I could have dinner with one person (dead or alive), who would it be?", o: ["Albert Einstein", "Steve Jobs", "Shah Rukh Khan", "My Grandfather"], a: "Steve Jobs" },
    { q: "If I was stranded on a desert island, what 3 things would I take?", o: ["Knife, Water, Book", "Phone, Powerbank, Friend", "Food, Tent, Lighter", "You, me, and our talks"], a: "Knife, Water, Book" },
    { q: "If my life was a movie, what would its title be?", o: ["Comedy of Errors", "The Great Adventure", "Work in Progress", "Mission Impossible"], a: "Work in Progress" },
    { q: "If I found a wallet full of money, what would I do?", o: ["Return it to owner", "Keep the cash, return wallet", "Keep it all", "Donate to charity"], a: "Return it to owner" },
    { q: "If I could change one thing about myself, what would it be?", o: ["My laziness", "My anger", "My overthinking", "I'm perfect"], a: "My overthinking" },
    { q: "If I could time travel, would I go to the past or future?", o: ["Past", "Future", "Stay in the present", "Both"], a: "Future" },
    { q: "If I had to eat one food for the rest of my life, what would it be?", o: ["Dal Chawal", "Pizza", "Chicken Curry", "Noodles"], a: "Dal Chawal" },
    { q: "If I could be famous for one thing, what would it be?", o: ["Being an actor", "Being a scientist", "Being a humanitarian", "Being a sports star"], a: "Being a scientist" },
    { q: "If I get a day off, I would prefer to:", o: ["Sleep all day", "Go on a long drive", "Binge-watch shows", "Hang out with friends"], a: "Binge-watch shows" },
    { q: "If I were a flavour, what would I be?", o: ["Sweet", "Spicy", "Salty", "Sour"], a: "Spicy" }
  ];

// Random Quiz Questions
const randomQuizQuestions = [
    {
        q: "What's the most important quality in a friendship?",
        o: ["Honesty", "Loyalty", "Trust", "Communication"],
        a: "Trust",
        e: "Trust forms the foundation of any strong friendship. Without trust, it's difficult to be vulnerable and open with your friends."
    },
    {
        q: "How often should friends check in on each other?",
        o: ["Daily", "Weekly", "Monthly", "Whenever we feel like it"],
        a: "Weekly",
        e: "Weekly check-ins strike a good balance between staying connected and giving each other space. Of course, this can vary based on the friendship!"
    },
    {
        q: "What's the best way to resolve a conflict with a friend?",
        o: ["Talk it out openly", "Give each other space", "Get a mutual friend to mediate", "Ignore it and hope it goes away"],
        a: "Talk it out openly",
        e: "Open communication is key to resolving conflicts. Addressing issues directly and honestly helps prevent misunderstandings from growing."
    },
    {
        q: "What's the ideal length of a friendship?",
        o: ["A few months", "A few years", "Many years", "Lifelong"],
        a: "Lifelong",
        e: "While not all friendships last forever, the goal is often to build connections that can withstand the test of time and life changes."
    },
    {
        q: "How many close friends does the average person have?",
        o: ["1-2", "3-5", "6-10", "More than 10"],
        a: "3-5",
        e: "Research suggests that most people maintain about 3-5 close friendships throughout their adult lives. Quality is more important than quantity!"
    }
];

let creatorName = '', currentQuizForCreation = [], selectedQuestionCount = 5;
let currentQuizData = null, currentQuestionIndex = 0, score = 0, takerName = '';
let currentRandomQuestion = null;

// --- NOTIFICATION SYSTEM ---
function showNotification(title, message, type = 'success') {
  const notification = document.getElementById('notification');
  const titleEl = notification.querySelector('.notification-title');
  const messageEl = notification.querySelector('.notification-message');
  
  titleEl.textContent = title;
  messageEl.textContent = message;
  
  notification.className = 'notification show ' + type;
  
  setTimeout(() => {
    notification.classList.remove('show');
  }, 3000);
}

// --- PWA Install Prompt ---
let deferredPrompt;
const installPrompt = document.getElementById('installPrompt');
const installBtn = document.getElementById('installBtn');
const dismissBtn = document.getElementById('dismissBtn');

window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  setTimeout(() => {
    installPrompt.classList.add('show');
  }, 3000);
});

installBtn.addEventListener('click', async () => {
  if (deferredPrompt) {
    deferredPrompt.prompt();
    const { outcome } = await deferredPrompt.userChoice;
    if (outcome === 'accepted') {
      console.log('User accepted the install prompt');
      showNotification('Success!', 'BFF Quiz has been installed on your device.');
    } else {
      console.log('User dismissed the install prompt');
    }
    deferredPrompt = null;
    installPrompt.classList.remove('show');
  }
});

dismissBtn.addEventListener('click', () => {
  installPrompt.classList.remove('show');
});

// --- Page Navigation ---
function showPage(pageId) { 
  document.querySelectorAll('.container').forEach(el => el.classList.add('hidden')); 
  document.getElementById(pageId).classList.remove('hidden');
}

// --- Random Quiz Functions ---
function showRandomQuiz() {
  showPage('randomQuizPage');
  generateNewRandomQuestion();
}

function generateNewRandomQuestion() {
  // Reset result view if visible
  document.getElementById('randomQuiz').classList.remove('hidden');
  document.getElementById('randomResult').classList.add('hidden');
  
  // Select a random question
  const randomIndex = Math.floor(Math.random() * randomQuizQuestions.length);
  currentRandomQuestion = randomQuizQuestions[randomIndex];
  
  // Display the question
  document.getElementById('randomQuestionText').textContent = currentRandomQuestion.q;
  
  // Create option elements
  const optionsContainer = document.getElementById('randomOptions');
  optionsContainer.innerHTML = '';
  
  currentRandomQuestion.o.forEach((option, index) => {
    const optionDiv = document.createElement('div');
    optionDiv.className = 'option-item';
    optionDiv.innerHTML = `
      <input type="radio" id="randomOption${index}" name="randomAnswer" value="${option}">
      <label for="randomOption${index}">${option}</label>
    `;
    optionsContainer.appendChild(optionDiv);
  });
}

function submitRandomQuiz() {
  const selectedOption = document.querySelector('input[name="randomAnswer"]:checked');
  
  if (!selectedOption) {
    showNotification('Error', 'Please select an answer!', 'error');
    return;
  }
  
  // Show result
  document.getElementById('randomQuiz').classList.add('hidden');
  document.getElementById('randomResult').classList.remove('hidden');
  
  const isCorrect = selectedOption.value === currentRandomQuestion.a;
  document.getElementById('randomAnswerText').textContent = 
    `You selected: ${selectedOption.value} ${isCorrect ? '✓' : '✗'}`;
  
  document.getElementById('randomExplanation').textContent = currentRandomQuestion.e;
  
  // Show notification
  showNotification(
    isCorrect ? 'Correct!' : 'Not quite', 
    isCorrect ? 'Great job! You understand this aspect of friendship.' : 'That\'s an interesting perspective! Every friendship is different.'
  );
}

// --- About Page Functions ---
function showAboutPage() {
  showPage('aboutPage');
}

// --- Home Page Logic ---
function showCreate() {
    creatorName = document.getElementById('userName').value.trim();
    if (!creatorName) { 
      showNotification('Error', 'Please enter your name first!', 'error');
      return; 
    }
    setQuestionCount(5); 
    showPage('create');
}
function showCreatorHistory() {
    const history = JSON.parse(localStorage.getItem('creatorHistory') || '[]');
    const listEl = document.getElementById('creatorHistoryList');
    listEl.innerHTML = history.length === 0 ? '<p>You have not created any quizzes yet.</p>' : '';
    history.reverse().forEach(item => {
        const quiz = item.quiz;
        const isExpired = new Date() > new Date(quiz.expiry);
        const div = document.createElement('div');
        div.className = 'quiz-history-item';
        div.innerHTML = `<strong>Quiz created on ${new Date(item.date).toLocaleDateString()}</strong><br>
                         ${quiz.questions.length} questions, by ${quiz.creator}
                         ${isExpired ? '<div class="expiry-notice" style="color:#ff6b6b; font-size:0.8rem;">EXPIRED</div>' : ''}`;
        div.onclick = () => showLeaderboardForCreator(item.quiz.id, `Quiz from ${new Date(item.date).toLocaleDateString()}`);
        listEl.appendChild(div);
    });
    showCreatorHistoryList();
    showPage('creatorHistoryPage');
}
function showPlayerHistory() {
    const history = JSON.parse(localStorage.getItem('playerHistory') || '[]');
    const listEl = document.getElementById('playerHistoryList');
    listEl.innerHTML = history.length === 0 ? "<p>You haven't played any quizzes yet. Your scores will appear here.</p>" : "";
    history.reverse().forEach(item => {
        const div = document.createElement('div');
        div.className = 'quiz-history-item';
        div.innerHTML = `<strong>Quiz by ${item.creator}</strong><br>
                         Your Score: <b>${item.score}/${item.total}</b> | Played on: ${new Date(item.date).toLocaleDateString()}`;
        div.onclick = () => window.location.href = item.url;
        listEl.appendChild(div);
    });
    showPage('playerHistoryPage');
}

// --- Creator Leaderboard Logic ---
function showLeaderboardForCreator(quizId, quizTitle) {
    document.getElementById('creatorHistoryWrapper').classList.add('hidden');
    const view = document.getElementById('creatorLeaderboardView');
    view.classList.remove('hidden');

    document.getElementById('creatorLeaderboardTitle').textContent = `Leaderboard for: ${quizTitle}`;
    const listEl = document.getElementById('creatorLeaderboardList');
    const allScores = JSON.parse(localStorage.getItem('allScores') || '{}');
    const leaderboardData = allScores[quizId] || [];
    
    document.getElementById('creatorPlayerCount').textContent = `Total Players: ${leaderboardData.length}`;

    if (leaderboardData.length === 0) listEl.innerHTML = '<p style="text-align:center; margin-top:20px;">No one has played this quiz yet.</p>';
    else listEl.innerHTML = leaderboardData.map((entry, index) => `<div class="leaderboard-item"><strong>${index + 1}. ${entry.name}</strong><span style="float:right; font-weight:bold;">${entry.score}/${entry.total}</span></div>`).join('');
}
function showCreatorHistoryList() {
    document.getElementById('creatorHistoryWrapper').classList.remove('hidden');
    document.getElementById('creatorLeaderboardView').classList.add('hidden');
}


// --- Quiz Creation Logic ---
function setQuestionCount(count) {
    selectedQuestionCount = count;
    document.querySelectorAll('.count-btn').forEach(btn => btn.classList.remove('active-count'));
    const btnIndex = [5,10,15,20].indexOf(count);
    if(btnIndex > -1) document.querySelector(`.count-btn:nth-child(${btnIndex+1})`).classList.add('active-count');
    currentQuizForCreation = [];
    renderCreationQuestions();
}
function showQuestionModal() { 
  document.getElementById('questionModal').classList.remove('hidden');
  renderModalList(); 
}
function closeQuestionModal() { 
  document.getElementById('questionModal').classList.add('hidden'); 
}
function renderModalList() {
    const listEl = document.getElementById('questionList');
    const filter = document.getElementById('questionSearch').value.toLowerCase();
    listEl.innerHTML = '';
    allQuestions.filter(q => q.q.toLowerCase().includes(filter)).forEach(q => {
        const originalIndex = allQuestions.indexOf(q);
        const item = document.createElement('label');
        item.className = 'modal-question-item';
        item.innerHTML = `<input type="checkbox" value="${originalIndex}">${q.q}`;
        listEl.appendChild(item);
    });
    updateModalCounter();
}
function updateModalCounter() {
    const selectedCount = document.querySelectorAll('#questionList input[type="checkbox"]:checked').length;
    document.getElementById('modalCounter').textContent = `${selectedCount} / ${selectedQuestionCount} selected`;
}
document.getElementById('questionList').addEventListener('change', updateModalCounter);
function addSelectedQuestions() {
    const selectedCheckboxes = document.querySelectorAll('#questionList input[type="checkbox"]:checked');
    if (selectedCheckboxes.length > selectedQuestionCount) { 
      showNotification('Error', `You can select a maximum of ${selectedQuestionCount} questions.`, 'error');
      return; 
    }
    if (selectedCheckboxes.length === 0) { 
      showNotification('Error', 'Please select at least one question.', 'error');
      return; 
    }
    currentQuizForCreation = Array.from(selectedCheckboxes).map(cb => JSON.parse(JSON.stringify(allQuestions[cb.value])));
    renderCreationQuestions(); 
    closeQuestionModal();
    showNotification('Success', 'Questions added successfully!');
}
function shuffleSelectedQuestions() {
    if (currentQuizForCreation.length === 0) { 
      showNotification('Error', 'Please select questions before shuffling.', 'error');
      return; 
    }
    for (let i = currentQuizForCreation.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [currentQuizForCreation[i], currentQuizForCreation[j]] = [currentQuizForCreation[j], currentQuizForCreation[i]];
    }
    renderCreationQuestions();
    showNotification('Success', 'Your selected questions have been shuffled!');
}
function renderCreationQuestions() {
    const container = document.getElementById('questionsContainer');
    container.innerHTML = '';
    if (currentQuizForCreation.length === 0) {
        container.innerHTML = '<p style="text-align:center; opacity: 0.7;">Your selected questions will appear here for final review.</p>';
        document.getElementById('creationControls').classList.add('hidden');
        document.getElementById('questionCounter').textContent = '';
        return;
    }
    currentQuizForCreation.forEach((q, index) => container.appendChild(createQuestionBlock(q, index)));
    document.getElementById('questionCounter').textContent = `Reviewing ${currentQuizForCreation.length} Questions`;
    document.getElementById('creationControls').classList.remove('hidden');
}
function createQuestionBlock(q, index) {
    const div = document.createElement('div');
    div.className = 'question-block';
    div.innerHTML = `<input type="text" class="question-title" value="${q.q}" oninput="updateCreationQuestion(${index}, 'q', this.value)">
        ${q.o.map((opt, optIndex) => `<div class="option-item"><input type="radio" name="correct-ans-${index}" value="${opt}" ${q.a === opt ? 'checked' : ''} onchange="updateCreationAnswer(${index}, this.value)"><input type="text" value="${opt}" oninput="updateCreationOption(${index}, ${optIndex}, this.value)">${q.a === opt ? '<span class="correct-tick">✓</span>' : ''}</div>`).join('')}`;
    return div;
}

function updateCreationQuestion(index, key, value) {
    currentQuizForCreation[index][key] = value;
}

function updateCreationOption(qIndex, optIndex, value) {
    const oldVal = currentQuizForCreation[qIndex].o[optIndex];
    if (currentQuizForCreation[qIndex].a === oldVal) {
        currentQuizForCreation[qIndex].a = value;
    }
    currentQuizForCreation[qIndex].o[optIndex] = value;
}
function updateCreationAnswer(index, value) {
    currentQuizForCreation[index].a = value;
    renderCreationQuestions(); // Refresh only when radio button is clicked
}

// --- NEW: Using JSONBlob for URL Shortening ---
async function saveQuizToJSONBlob(data) {
    const response = await fetch('https://jsonblob.com/api/jsonBlob', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
        },
        body: JSON.stringify(data)
    });
    if (!response.ok) {
        throw new Error('Failed to create quiz data blob.');
    }
    const location = response.headers.get('Location');
    return location.split('/').pop(); // Extract the ID from the full URL
}

async function loadQuizFromJSONBlob(id) {
    const response = await fetch(`https://jsonblob.com/api/jsonBlob/${id}`);
    if (!response.ok) {
        throw new Error('Failed to load quiz data.');
    }
    return await response.json();
}

async function finishAndShareQuiz() {
    const finishButton = document.querySelector('#creationControls button:last-child');
    finishButton.disabled = true;
    finishButton.textContent = 'Creating Link...';

    const expiryDate = new Date(); expiryDate.setHours(expiryDate.getHours() + 24);
    const quizData = { id: 'quiz_' + Date.now(), creator: creatorName, questions: currentQuizForCreation, expiry: expiryDate.toISOString() };

    try {
        const blobId = await saveQuizToJSONBlob(quizData);
        const url = `${window.location.href.split('?')[0].split('#')[0]}#play?id=${blobId}`;
        saveCreatorHistory(quizData, url); 
        displayShareableLink(url);
    } catch (e) {
        console.error("Quiz creation failed:", e);
        showNotification('Error', 'Could not create quiz link. Please try again.', 'error');
    } finally {
        finishButton.disabled = false;
        finishButton.textContent = 'Finish & Share Link';
    }
}
function saveCreatorHistory(quizData, url) {
    let history = JSON.parse(localStorage.getItem('creatorHistory') || '[]');
    history.push({ quiz: quizData, url: url, date: new Date().toISOString() });
    if (history.length > 20) history.shift();
    localStorage.setItem('creatorHistory', JSON.stringify(history));
}
function displayShareableLink(url) {
    showPage('result');
    document.getElementById('resultTitle').textContent = "Quiz Created Successfully!";
    document.getElementById('leaderboard').classList.add('hidden');
    document.getElementById('scoreText').innerHTML = `<p style="text-align:center;">Your quiz is ready to be shared!</p>`;
    const shareBox = document.getElementById('shareBox');
    shareBox.classList.remove('hidden');
    document.getElementById('shareLink').textContent = url;
    const homeUrl = window.location.href.split('?')[0].split('#')[0];
    const shareMessage = `🔥 ${creatorName} has challenged you to a Friendship Quiz! 🔥\n\n"Kya tum sach me mujhe jaante ho? 🤔\n\nClick here to prove it and see your score! 👉 ${url}\n\n---\n👉 Create your own quiz here: ${homeUrl}`;
    const encodedShareMessage = encodeURIComponent(shareMessage);
    const encodedUrl = encodeURIComponent(url);
    const encodedTitle = encodeURIComponent(`🔥 ${creatorName} has challenged you!`);
    
    document.getElementById('socialShareButtons').innerHTML = `
        <button class="btn-purple social-btn-stacked" onclick="copyToClipboard(document.getElementById('shareLink').textContent)">Copy Quiz Link</button>
        <a href="https://api.whatsapp.com/send?text=${encodedShareMessage}" target="_blank" class="btn-purple social-btn-stacked">WhatsApp</a>
        <a href="https://t.me/share/url?url=${encodedUrl}&text=${encodedTitle}" target="_blank" class="btn-purple social-btn-stacked">Telegram</a>
        <a href="https://www.facebook.com/sharer/sharer/sharer/sharer/sharer/sharer/sharer/sharer/sharer/sharer/sharer/sharer/sharer/sharer/sharer/sharer/sharer/sharer.php?u=${encodedUrl}" target="_blank" class="btn-purple social-btn-stacked">Facebook</a>
        <button onclick="shareOnInstagram()" class="btn-purple social-btn-stacked">Instagram</button>
        <a href="https://twitter.com/intent/tweet?url=${encodedUrl}&text=${encodedTitle}" target="_blank" class="btn-purple social-btn-stacked">Twitter</a>
        <a href="https://www.threads.net/share?text=${encodedTitle}&url=${encodedUrl}" target="_blank" class="btn-purple social-btn-stacked">Threads</a>
    `;
}
function shareOnInstagram() {
    const url = document.getElementById('shareLink').textContent;
    navigator.clipboard.writeText(`Check out this quiz! ${url}`).then(() => {
        showNotification('Success', 'Link Copied! Now opening Instagram. Paste the link in your story or bio.');
        window.open('https://www.instagram.com', '_blank');
    });
}
function copyToClipboard(text) { 
  navigator.clipboard.writeText(text).then(() => {
    showNotification('Success', 'Link copied!');
  }, () => {
    showNotification('Error', 'Failed to copy.', 'error'); 
  }); 
}

// --- Quiz Taking & Results Logic ---
async function routeOnLoad() {
    const hash = window.location.hash;
    const path = window.location.pathname;
    
    // Check if it's the about page
    if (path === '/about') {
        showAboutPage();
        return;
    }
    
    // Check if it's the random quiz page
    if (path === '/random') {
        showRandomQuiz();
        return;
    }
    
    if (hash.startsWith('#play?id=')) {
        const params = new URLSearchParams(hash.substring(6)); // #play?id=... -> id=...
        const blobId = params.get('id');
        if (!blobId) {
            showPage('home');
            return;
        }
        try {
            currentQuizData = await loadQuizFromJSONBlob(blobId);
            if (new Date() > new Date(currentQuizData.expiry)) {
                showPage('home');
                document.getElementById('home').insertAdjacentHTML('afterbegin', '<div class="alert-box">This quiz link has expired (valid for 24 hours).</div>');
                window.location.hash = '';
                return;
            }
            showPage('play');
            document.getElementById('quizTitle').textContent = `A quiz by ${currentQuizData.creator}`;
            document.getElementById('playTakerName').classList.remove('hidden');
            document.getElementById('quizContentWrapper').classList.add('hidden');
        } catch (e) { 
          console.error("Error loading quiz data:", e); 
          showPage('home'); 
          showNotification('Error', 'Invalid or corrupted quiz link.', 'error');
          window.location.hash = ''; 
        }
    } else if (hash.startsWith('#dummy')) {
        showPage('dummyPage');
    } else if (hash.startsWith('#hidden')) {
        showPage('hiddenPage');
    } else { showPage('home'); }
}
function startQuiz() {
    takerName = document.getElementById('takerName').value.trim();
    if (!takerName) { 
      showNotification('Error', 'Please enter your name to start.', 'error');
      return; 
    }
    document.getElementById('playTakerName').classList.add('hidden');
    document.getElementById('quizContentWrapper').classList.remove('hidden');
    loadQuestion();
}
function loadQuestion() {
    if (currentQuestionIndex >= currentQuizData.questions.length) { finishQuiz(); return; }
    const q = currentQuizData.questions[currentQuestionIndex];
    document.getElementById('quizContent').innerHTML = `<div class="question-block"><h3>Q ${currentQuestionIndex + 1}: ${q.q}</h3><div class="option-grid">${q.o.map(opt => `<label class="option-item"><input type="radio" name="answer" value="${opt}">${opt}</label>`).join("")}</div><button class="btn-purple" onclick="submitAnswer()">Next Question</button></div></div>`;
    document.getElementById('inQuizAd').classList.remove('hidden'); // Show ad with question
}
function submitAnswer() {
    const selected = document.querySelector('input[name="answer"]:checked');
    if (!selected) { 
      showNotification('Error', 'Please select an answer.', 'error');
      return; 
    }
    if (selected.value === currentQuizData.questions[currentQuestionIndex].a) score++;
    currentQuestionIndex++; 
    loadQuestion();
}
function finishQuiz() { 
  saveScore(); 
  displayResults(); 
  showNotification('Quiz Complete!', `You scored ${score} out of ${currentQuizData.questions.length}!`);
}
function displayResults() {
    showPage('result');
    document.getElementById('resultTitle').textContent = "Quiz Complete!";
    document.getElementById('leaderboard').classList.remove('hidden');
    document.getElementById('shareBox').classList.add('hidden');
    document.getElementById('quizContentWrapper').classList.add('hidden'); // Hide the in-quiz ad wrapper
    document.getElementById('scoreText').innerHTML = `<h3 style="text-align:center;">Congratulations, ${takerName}!</h3><p style="font-size: 1.2rem; margin: 10px 0; text-align:center;">You scored ${score} out of ${currentQuizData.questions.length}</p>`;
    updateLeaderboard();
}
function saveScore() {
    const quizId = currentQuizData.id;
    // Save to leaderboard
    let allScores = JSON.parse(localStorage.getItem('allScores') || '{}');
    if (!allScores[quizId]) allScores[quizId] = [];
    const existingIndex = allScores[quizId].findIndex(e => e.name === takerName);
    if (existingIndex > -1) { if (score > allScores[quizId][existingIndex].score) allScores[quizId][existingIndex] = { name: takerName, score, total: currentQuizData.questions.length }; }
    else { 
        allScores[quizId].push({ name: takerName, score, total: currentQuizData.questions.length, date: new Date().toISOString(), url: window.location.href });
        // Save to player history
        let playerHistory = JSON.parse(localStorage.getItem('playerHistory') || '[]');
        playerHistory.push({ 
            creator: currentQuizData.creator, 
            score: score, 
            total: currentQuizData.questions.length, 
            date: new Date().toISOString(), 
            url: window.location.href 
        });
        if(playerHistory.length > 20) playerHistory.shift();
        localStorage.setItem('playerHistory', JSON.stringify(playerHistory));
    }
    localStorage.setItem('allScores', JSON.stringify(allScores));
}
function updateLeaderboard() {
    const listEl = document.getElementById('leaderboardList');
    const allScores = JSON.parse(localStorage.getItem('allScores') || '{}');
    const leaderboardData = allScores[currentQuizData.id] || [];
    if (leaderboardData.length === 0) listEl.innerHTML = '<p>Be the first to set a score!</p>';
    else listEl.innerHTML = leaderboardData.map((entry, index) => `<div class="leaderboard-item"><strong>${index + 1}. ${entry.name}</strong><span style="float:right; font-weight:bold;">${entry.score}/${entry.total}</span></div>`).join('');
}

// Initialize app on page load
window.addEventListener('load', routeOnLoad);
window.addEventListener('hashchange', routeOnLoad);
</script>
</body>
</html>